<!DOCTYPE HTML >
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>登录页面</title>
	<link rel="stylesheet" type="text/css" href="css/main.css" />
	<script type="text/javascript" src="js/jquery-1.9.1.min.js"></script>
	<script type="text/javascript" src="js/util.js"></script>
</head>

<body>
<div class="login-form">
	<div class="title">信源管理系统</div>
	<form>
		<div class="item">
			<input type="text" id="usrinput" placeholder="用户名" />
			<img id="usrimg" src="images/useractive.png" alt="" />
		</div>
		<div class="item">
			<input type="password" id="psdinput" placeholder="密码" />
			<img id="psdimg" src="images/passwordactive.png" alt="" />
		</div>
		<div class="item">
			<input type="button" value="登录" onclick="test()" />
		</div>
	</form>
</div>
</body>
<script type="text/javascript">
    $(document).ready(function(){
	   document.getElementById("usrinput").focus();
	});
	document.onkeydown = function(e) {
		var theEvent = window.event || e;
		var code = theEvent.keyCode || theEvent.which;
		if (code == 13) {
			test();
		}
	};
	function login(){
		var username = $$("usrinput").value;
		var password = $$("psdinput").value;
		param = username + ";" + password;
		var xmlhttp = new XMLHttpRequest();
		xmlhttp.onreadystatechange=function(){
			if(xmlhttp.readyState == 4){
				if(xmlhttp.status == 200){
					var responsetxt = xmlhttp.responseText;
					//返回1::zhao alert("responsetxt==1::zhao");
					var qxian = parseInt(responsetxt.substr(0,responsetxt.indexOf("::")));
					var name=responsetxt.substr(responsetxt.indexOf("::")+2,responsetxt.length);
					if(qxian == 1 || qxian ==2){
						setCookie("qxian",qxian,0);
						setCookie("name",name,0);
						window.location.href = "./index.html";
					}else{
						alert("用户名或密码错误,登录失败！");
					}
				}
			}
		};
		xmlhttp.open("POST","user!login",true);
		xmlhttp.send(param);
	}
</script>

</html>
